<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Rarify (subsample) biological sample to fixed count — rarify • BioMonTools</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Rarify (subsample) biological sample to fixed count — rarify" />
<meta property="og:description" content="Takes as an input a 3 column data frame (SampleID, TaxonID
, Count) and returns a similar dataframe with revised Counts.
The other inputs are subsample size (target number of organisms in each
sample) and seed. The seed is given so the results can be reproduced from the
 same input file.  If no seed is given a random seed is used." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BioMonTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.0.9047</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/vignette_BioMonTools.html">Vignette, BioMonTools</a>
    </li>
    <li>
      <a href="../articles/vignette_MapTaxaObs.html">Vignette, Taxa Maps</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/leppott/BioMonTools/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Rarify (subsample) biological sample to fixed count</h1>
    <small class="dont-index">Source: <a href='https://github.com/leppott/BioMonTools/blob/master/R/rarify.R'><code>R/rarify.R</code></a></small>
    <div class="hidden name"><code>rarify.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Takes as an input a 3 column data frame (SampleID, TaxonID
, Count) and returns a similar dataframe with revised Counts.</p>
<p>The other inputs are subsample size (target number of organisms in each
sample) and seed. The seed is given so the results can be reproduced from the
 same input file.  If no seed is given a random seed is used.</p>
    </div>

    <pre class="usage"><span class='fu'>rarify</span><span class='op'>(</span><span class='va'>inbug</span>, <span class='va'>sample.ID</span>, <span class='va'>abund</span>, <span class='va'>subsiz</span>, mySeed <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>inbug</th>
      <td><p>Input data frame.  Needs 3 columns (SampleID, taxonomicID
, Count).</p></td>
    </tr>
    <tr>
      <th>sample.ID</th>
      <td><p>Column name in inbug for sample identifier.</p></td>
    </tr>
    <tr>
      <th>abund</th>
      <td><p>Column name in inbug for organism count.</p></td>
    </tr>
    <tr>
      <th>subsiz</th>
      <td><p>Target subsample size for each sample.</p></td>
    </tr>
    <tr>
      <th>mySeed</th>
      <td><p>Seed for random number generator.  If provided the results with
the same inbug file will produce the same results. Defaut = NA (random seed
will be used.)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a data frame with the same three columns but the abund field
has been modified so the total count for each sample is no longer above the
target (subsiz).</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>rarify function:
 R function to rarify (subsample) a macroinvertebrate sample down to a fixed
 count; by John Van Sickle, USEPA. email: VanSickle.John@epa.gov ;
 Version 1.0, 06/10/05;</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Subsample to 500 organisms (from over 500 organisms) for 12 samples.</span>

<span class='co'># load bio data</span>
<span class='va'>df_biodata</span> <span class='op'>&lt;-</span> <span class='va'>data_bio2rarify</span>
<span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>df_biodata</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 350   3</div><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/View.html'>View</a></span><span class='op'>(</span><span class='va'>df_biodata</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># subsample</span>
<span class='va'>mySize</span> <span class='op'>&lt;-</span> <span class='fl'>500</span>
<span class='va'>Seed_OR</span> <span class='op'>&lt;-</span> <span class='fl'>18590214</span>
<span class='va'>Seed_WA</span> <span class='op'>&lt;-</span> <span class='fl'>18891111</span>
<span class='va'>Seed_US</span> <span class='op'>&lt;-</span> <span class='fl'>17760704</span>
<span class='va'>bugs_mysize</span> <span class='op'>&lt;-</span> <span class='fu'>rarify</span><span class='op'>(</span>inbug<span class='op'>=</span><span class='va'>df_biodata</span>, sample.ID<span class='op'>=</span><span class='st'>"SampleID"</span>
                     ,abund<span class='op'>=</span><span class='st'>"N_Taxa"</span>,subsiz<span class='op'>=</span><span class='va'>mySize</span>, mySeed<span class='op'>=</span><span class='va'>Seed_US</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Rarify of samples complete. 
#&gt;  Number of samples =  12 
#&gt;  Execution time (sec) =  0.01400000000001</div><div class='input'>
<span class='co'># view results</span>
<span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>bugs_mysize</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 350   3</div><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/View.html'>View</a></span><span class='op'>(</span><span class='va'>bugs_mysize</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># Compare pre- and post- subsample counts</span>
<span class='va'>df_compare</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/merge.html'>merge</a></span><span class='op'>(</span><span class='va'>df_biodata</span>, <span class='va'>bugs_mysize</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"SampleID"</span>, <span class='st'>"TaxaID"</span><span class='op'>)</span>
                    , suffixes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"_Orig"</span>,<span class='st'>"_500"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>df_compare</span> <span class='op'>&lt;-</span> <span class='va'>df_compare</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"SampleID"</span>
                             , <span class='st'>"TaxaID"</span>
                             , <span class='st'>"N_Taxa_Orig"</span>
                             , <span class='st'>"N_Taxa_500"</span><span class='op'>)</span><span class='op'>]</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/View.html'>View</a></span><span class='op'>(</span><span class='va'>df_compare</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># compare totals</span>
<span class='va'>tbl_totals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/aggregate.html'>aggregate</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>N_Taxa_Orig</span>, <span class='va'>N_Taxa_500</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>SampleID</span>
                                                     , <span class='va'>df_compare</span>, <span class='va'>sum</span><span class='op'>)</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/View.html'>View</a></span><span class='op'>(</span><span class='va'>tbl_totals</span><span class='op'>)</span>

<span class='co'># save the data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.table</a></span><span class='op'>(</span><span class='va'>bugs_mysize</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"bugs"</span>,<span class='va'>mySize</span>,<span class='st'>"txt"</span>,sep<span class='op'>=</span><span class='st'>"."</span><span class='op'>)</span>,sep<span class='op'>=</span><span class='st'>"\t"</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Erik W. Leppo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


