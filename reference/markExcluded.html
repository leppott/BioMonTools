<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Mark "exclude" (non-distinct / non-unique / ambiguous) taxa — markExcluded • BioMonTools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Mark " exclude non-unique ambiguous taxa markexcluded><meta property="og:description" content='Takes as an input data frame with Sample ID, Taxa ID, and
phlogenetic name fields and returns a similar dataframe with a column for
"exclude" taxa (TRUE or FALSE).
Exclude taxa are refered to by multiple names; ambiguous, non-distinct, and
non-unique. The "exclude" name was chosen so as to be consistent with
"non-target" taxa. That is, taxa marked as "TRUE" are treated as
undesireables.  Exclude taxa are those that are present in a sample when
taxa of the same group are present in the same sample are identified finer
level.  That is, the parent is marked as exclude when child taxa are
present in the same sample.'><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BioMonTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/vignette_BioMonTools.html">Vignette, BioMonTools</a>
    </li>
    <li>
      <a href="../articles/vignette_MapTaxaObs.html">Taxa Maps</a>
    </li>
    <li>
      <a href="../articles/vignette_NewIndex.html">Vignette, Adding a New Index</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/leppott/BioMonTools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Mark "exclude" (non-distinct / non-unique / ambiguous) taxa</h1>
    <small class="dont-index">Source: <a href="https://github.com/leppott/BioMonTools/blob/CRAN_v1.2.4/R/markExcluded.R" class="external-link"><code>R/markExcluded.R</code></a></small>
    <div class="hidden name"><code>markExcluded.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Takes as an input data frame with Sample ID, Taxa ID, and
phlogenetic name fields and returns a similar dataframe with a column for
"exclude" taxa (TRUE or FALSE).</p>
<p>Exclude taxa are refered to by multiple names; ambiguous, non-distinct, and
non-unique. The "exclude" name was chosen so as to be consistent with
"non-target" taxa. That is, taxa marked as "TRUE" are treated as
undesireables.  Exclude taxa are those that are present in a sample when
taxa of the same group are present in the same sample are identified finer
level.  That is, the parent is marked as exclude when child taxa are
present in the same sample.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">markExcluded</span><span class="op">(</span></span>
<span>  <span class="va">df_samptax</span>,</span>
<span>  SampID <span class="op">=</span> <span class="st">"SAMPLEID"</span>,</span>
<span>  TaxaID <span class="op">=</span> <span class="st">"TAXAID"</span>,</span>
<span>  TaxaCount <span class="op">=</span> <span class="st">"N_TAXA"</span>,</span>
<span>  Exclude <span class="op">=</span> <span class="st">"EXCLUDE"</span>,</span>
<span>  <span class="va">TaxaLevels</span>,</span>
<span>  Exceptions <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-df-samptax">df_samptax<a class="anchor" aria-label="anchor" href="#arg-df-samptax"></a></dt>
<dd><p>Input data frame.</p></dd>


<dt id="arg-sampid">SampID<a class="anchor" aria-label="anchor" href="#arg-sampid"></a></dt>
<dd><p>Column name in df_samptax for sample identifier.
Default = "SAMPLEID".</p></dd>


<dt id="arg-taxaid">TaxaID<a class="anchor" aria-label="anchor" href="#arg-taxaid"></a></dt>
<dd><p>Column name in df_samptax for organism identifier.
Default = "TAXAID".</p></dd>


<dt id="arg-taxacount">TaxaCount<a class="anchor" aria-label="anchor" href="#arg-taxacount"></a></dt>
<dd><p>Column name in df_samptax for organism count.
Default = "N_TAXA".</p></dd>


<dt id="arg-exclude">Exclude<a class="anchor" aria-label="anchor" href="#arg-exclude"></a></dt>
<dd><p>Column name for Exclude Taxa results in returned data frame.
Default = "Exclude".</p></dd>


<dt id="arg-taxalevels">TaxaLevels<a class="anchor" aria-label="anchor" href="#arg-taxalevels"></a></dt>
<dd><p>Column names in df_samptax that for phylogenetic names to
be evaluated.
Need to be in order from coarse to fine (i.e., Phylum to Species).</p></dd>


<dt id="arg-exceptions">Exceptions<a class="anchor" aria-label="anchor" href="#arg-exceptions"></a></dt>
<dd><p>NA or two column data frame of synonyms or other
exceptions.  Default = NA
Column 1 is the name used in the TaxaID column of df_samptax.
Column 2 is the name used in the TaxaLevels columns of df_samptax.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Boolean value for if status messages are output to the console.
Default = FALSE</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Returns a data frame of df_samptax with an additional column,
Exclude.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The exclude taxa are referenced in the metric values function.
These taxa are removed from the taxa richness metrics.  This is because these
are coarser level taxa when fine level taxa are present in the same sample.</p>
<p>Exceptions is a 2 column data frame of synonyms or other exceptions.
Column 1 is the name used in the TaxaID column the input data frame
(df_samptax). Column 2 is the name used in the TaxaLevels columns of the
input data frame (df_samptax).  The phylogenetic columns (TaxaLevels) will be
modified from Column 2 of the Exceptions data frame to match Column 1 of the
Exceptions data frame.  This ensures that the algorithm for markExcluded
works properly. The changes will not be stored and the original names
provided in the input data frame (df_samptax) will be returned in the final
result.  The function example below includes a practical case.</p>
<p>Taxa Levels are phylogenetic names that are to be checked.  They should be
listed in order from course (kingdom) to fine (species).  Names not appearing
in the data will be skipped.</p>
<p>The spelling of names must be consistent (including case) for this function
to produce the intended output.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Packages</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org" class="external-link">readxl</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘dplyr’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:stats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     filter, lag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     intersect, setdiff, setequal, union</span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">lazyeval</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Data</span></span></span>
<span class="r-in"><span><span class="va">df_samps_bugs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"./extdata/Data_Benthos.xlsx"</span>,</span></span>
<span class="r-in"><span>                                        package<span class="op">=</span><span class="st">"BioMonTools"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            guess_max<span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Variables</span></span></span>
<span class="r-in"><span><span class="va">SampID</span>     <span class="op">&lt;-</span> <span class="st">"SampleID"</span></span></span>
<span class="r-in"><span><span class="va">TaxaID</span>     <span class="op">&lt;-</span> <span class="st">"TaxaID"</span></span></span>
<span class="r-in"><span><span class="va">TaxaCount</span>  <span class="op">&lt;-</span> <span class="st">"N_Taxa"</span></span></span>
<span class="r-in"><span><span class="va">Exclude</span>    <span class="op">&lt;-</span> <span class="st">"Exclude_New"</span></span></span>
<span class="r-in"><span><span class="va">TaxaLevels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Kingdom"</span>,</span></span>
<span class="r-in"><span>                <span class="st">"Phylum"</span>,</span></span>
<span class="r-in"><span>                <span class="st">"SubPhylum"</span>,</span></span>
<span class="r-in"><span>                <span class="st">"Class"</span>,</span></span>
<span class="r-in"><span>                <span class="st">"SubClass"</span>,</span></span>
<span class="r-in"><span>                <span class="st">"Order"</span>,</span></span>
<span class="r-in"><span>                <span class="st">"SubOrder"</span>,</span></span>
<span class="r-in"><span>                <span class="st">"SuperFamily"</span>,</span></span>
<span class="r-in"><span>                <span class="st">"Family"</span>,</span></span>
<span class="r-in"><span>                <span class="st">"SubFamily"</span>,</span></span>
<span class="r-in"><span>                <span class="st">"Tribe"</span>,</span></span>
<span class="r-in"><span>                <span class="st">"Genus"</span>,</span></span>
<span class="r-in"><span>                <span class="st">"SubGenus"</span>,</span></span>
<span class="r-in"><span>                <span class="st">"Species"</span>,</span></span>
<span class="r-in"><span>                <span class="st">"Variety"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Taxa that should be treated as equivalent</span></span></span>
<span class="r-in"><span><span class="va">Exceptions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"TaxaID"</span> <span class="op">=</span> <span class="st">"Sphaeriidae"</span>,</span></span>
<span class="r-in"><span>                         <span class="st">"PhyloID"</span> <span class="op">=</span> <span class="st">"Pisidiidae"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 1</span></span></span>
<span class="r-in"><span><span class="va">df_tst</span> <span class="op">&lt;-</span> <span class="fu">markExcluded</span><span class="op">(</span><span class="va">df_samps_bugs</span>,</span></span>
<span class="r-in"><span>                       SampID <span class="op">=</span> <span class="st">"SampleID"</span>,</span></span>
<span class="r-in"><span>                       TaxaID <span class="op">=</span> <span class="st">"TaxaID"</span>,</span></span>
<span class="r-in"><span>                       TaxaCount <span class="op">=</span> <span class="st">"N_Taxa"</span>,</span></span>
<span class="r-in"><span>                       Exclude <span class="op">=</span> <span class="st">"Exclude_New"</span>,</span></span>
<span class="r-in"><span>                       TaxaLevels <span class="op">=</span> <span class="va">TaxaLevels</span>,</span></span>
<span class="r-in"><span>                       Exceptions <span class="op">=</span> <span class="va">Exceptions</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> *WARNING*, 3 taxa levels missing from input data frame; </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  KINGDOM, SUBORDER, VARIETY</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare</span></span></span>
<span class="r-in"><span><span class="va">df_compare</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">df_tst</span>, <span class="va">SampleID</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                               Exclude_Import <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Exclude</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                               Exclude_R <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Exclude_New</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df_compare</span><span class="op">$</span><span class="va">Diff</span> <span class="op">&lt;-</span> <span class="va">df_compare</span><span class="op">$</span><span class="va">Exclude_Import</span> <span class="op">-</span> <span class="va">df_compare</span><span class="op">$</span><span class="va">Exclude_R</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">tbl_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">df_compare</span><span class="op">$</span><span class="va">Diff</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">tbl_diff</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Var1 | Freq|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |:----|----:|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |0    |   47|</span>
<span class="r-in"><span><span class="co"># sort</span></span></span>
<span class="r-in"><span><span class="va">df_compare</span> <span class="op">&lt;-</span> <span class="va">df_compare</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">Diff</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Number with issues</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">df_compare</span><span class="op">$</span><span class="va">Diff</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-in"><span><span class="co"># total samples</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df_compare</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 47</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># confusion matrix</span></span></span>
<span class="r-in"><span><span class="va">tbl_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">df_tst</span><span class="op">$</span><span class="va">Exclude</span>, <span class="va">df_tst</span><span class="op">$</span><span class="va">Exclude_New</span>, useNA <span class="op">=</span> <span class="st">"ifany"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># Show differences</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">tbl_results</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |      | FALSE| TRUE|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |:-----|-----:|----:|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |FALSE |   144|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |TRUE  |     0|    1|</span>
<span class="r-in"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">df_compare</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |SampleID                  | Exclude_Import| Exclude_R| Diff|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |:-------------------------|--------------:|---------:|----:|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |02087REF_Bug_2002-08-22_0 |              0|         0|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |03054CSR_Bug_2003-08-18_0 |              0|         0|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |06012CSR_Bug_2006-09-05_0 |              0|         0|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |06027CSR_Bug_2006-07-17_0 |              0|         0|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |06029CSR_Bug_2006-09-27_0 |              0|         0|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |07036OPR_Bug_2007-09-27_0 |              0|         0|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |08CED2518__2015-08-13_0   |              0|         0|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |08ISS4294__2015-08-26_0   |              1|         1|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |08LAK3627__2015-08-10_0   |              0|         0|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |09JEN1318__2015-08-24_0   |              0|         0|    0|</span>
<span class="r-in"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">df_compare</span><span class="op">[</span><span class="fl">672</span><span class="op">:</span><span class="fl">678</span>, <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |SampleID | Exclude_Import| Exclude_R| Diff|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |:--------|--------------:|---------:|----:|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |NA       |             NA|        NA|   NA|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |NA       |             NA|        NA|   NA|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |NA       |             NA|        NA|   NA|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |NA       |             NA|        NA|   NA|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |NA       |             NA|        NA|   NA|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |NA       |             NA|        NA|   NA|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |NA       |             NA|        NA|   NA|</span>
<span class="r-in"><span><span class="co"># samples with differences</span></span></span>
<span class="r-in"><span><span class="va">samp_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">df_compare</span><span class="op">[</span><span class="va">df_compare</span><span class="op">[</span>,<span class="st">"Diff"</span><span class="op">]</span> <span class="op">!=</span> <span class="fl">0</span>, <span class="st">"SampleID"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># results for only those with differences</span></span></span>
<span class="r-in"><span><span class="va">df_tst_diff</span> <span class="op">&lt;-</span> <span class="va">df_tst</span><span class="op">[</span><span class="va">df_tst</span><span class="op">[</span>,<span class="st">"SampleID"</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">samp_diff</span><span class="op">$</span><span class="va">SampleID</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># add diff field</span></span></span>
<span class="r-in"><span><span class="va">df_tst_diff</span><span class="op">$</span><span class="va">Exclude_Diff</span> <span class="op">&lt;-</span> <span class="va">df_tst_diff</span><span class="op">$</span><span class="va">Exclude</span> <span class="op">-</span> <span class="va">df_tst_diff</span><span class="op">$</span><span class="va">Exclude_New</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Classification Performance Metrics</span></span></span>
<span class="r-in"><span><span class="va">class_TP</span> <span class="op">&lt;-</span> <span class="va">tbl_results</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="co"># True Positive</span></span></span>
<span class="r-in"><span><span class="va">class_FN</span> <span class="op">&lt;-</span> <span class="va">tbl_results</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="co"># False Negative</span></span></span>
<span class="r-in"><span><span class="va">class_FP</span> <span class="op">&lt;-</span> <span class="va">tbl_results</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="co"># False Positive</span></span></span>
<span class="r-in"><span><span class="va">class_TN</span> <span class="op">&lt;-</span> <span class="va">tbl_results</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="co"># True Negative</span></span></span>
<span class="r-in"><span><span class="va">class_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">tbl_results</span><span class="op">)</span>  <span class="co"># total</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># sensitivity (recall); TP / (TP+FN); measure model to ID true positives</span></span></span>
<span class="r-in"><span><span class="va">class_sens</span> <span class="op">&lt;-</span> <span class="va">class_TP</span> <span class="op">/</span> <span class="op">(</span><span class="va">class_TP</span> <span class="op">+</span> <span class="va">class_FN</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># precision; TP / (TP+FP); accuracy of model positives</span></span></span>
<span class="r-in"><span><span class="va">class_prec</span> <span class="op">&lt;-</span> <span class="va">class_TP</span> <span class="op">/</span> <span class="op">(</span><span class="va">class_TP</span> <span class="op">+</span> <span class="va">class_FP</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># specifity; TN / (TN + FP); measure model to ID true negatives</span></span></span>
<span class="r-in"><span><span class="va">class_spec</span> <span class="op">&lt;-</span> <span class="va">class_TN</span>  <span class="op">/</span> <span class="op">(</span><span class="va">class_TN</span> <span class="op">+</span> <span class="va">class_FP</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># overall accuracy; (TP + TN) / all cases; accuracy of all classifications</span></span></span>
<span class="r-in"><span><span class="va">class_acc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">class_TP</span> <span class="op">+</span> <span class="va">class_TN</span><span class="op">)</span> <span class="op">/</span> <span class="va">class_n</span></span></span>
<span class="r-in"><span><span class="co"># F1; 2 * (class_prec*class_sens) / (class_prec+class_sens)</span></span></span>
<span class="r-in"><span><span class="co">## balance of precision and recall</span></span></span>
<span class="r-in"><span><span class="va">class_F1</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">class_prec</span> <span class="op">*</span> <span class="va">class_sens</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">class_prec</span> <span class="op">+</span> <span class="va">class_sens</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">results_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sensitivity (Recall)"</span>,</span></span>
<span class="r-in"><span>                   <span class="st">"Precision"</span>,</span></span>
<span class="r-in"><span>                   <span class="st">"Specificity"</span>,</span></span>
<span class="r-in"><span>                   <span class="st">"Overall Accuracy"</span>,</span></span>
<span class="r-in"><span>                   <span class="st">"F1"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">results_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">class_sens</span>,</span></span>
<span class="r-in"><span>                    <span class="va">class_prec</span>,</span></span>
<span class="r-in"><span>                    <span class="va">class_spec</span>,</span></span>
<span class="r-in"><span>                    <span class="va">class_acc</span>,</span></span>
<span class="r-in"><span>                    <span class="va">class_F1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">tbl_class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">results_names</span>, <span class="va">results_values</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tbl_class</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Performance Metrics"</span>, <span class="st">"Percent"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tbl_class</span><span class="op">$</span><span class="va">Percent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">tbl_class</span><span class="op">$</span><span class="va">Percent</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">tbl_class</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Performance Metrics  | Percent|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |:--------------------|-------:|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Sensitivity (Recall) |     100|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Precision            |     100|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Specificity          |     100|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Overall Accuracy     |     100|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |F1                   |     100|</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 2</span></span></span>
<span class="r-in"><span><span class="co">## No Exceptions</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">df_tst2</span> <span class="op">&lt;-</span> <span class="fu">markExcluded</span><span class="op">(</span><span class="va">df_samps_bugs</span>,</span></span>
<span class="r-in"><span>                        SampID <span class="op">=</span> <span class="st">"SampleID"</span>,</span></span>
<span class="r-in"><span>                        TaxaID <span class="op">=</span> <span class="st">"TaxaID"</span>,</span></span>
<span class="r-in"><span>                        TaxaCount <span class="op">=</span> <span class="st">"N_Taxa"</span>,</span></span>
<span class="r-in"><span>                        Exclude <span class="op">=</span> <span class="st">"Exclude_New"</span>,</span></span>
<span class="r-in"><span>                        TaxaLevels <span class="op">=</span> <span class="va">TaxaLevels</span>,</span></span>
<span class="r-in"><span>                        Exceptions <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> *WARNING*, 3 taxa levels missing from input data frame; </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  KINGDOM, SUBORDER, VARIETY</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare</span></span></span>
<span class="r-in"><span><span class="va">df_compare2</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">df_tst2</span>, <span class="va">SampleID</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                Exclude_Import <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Exclude</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                Exclude_R <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Exclude_New</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df_compare2</span><span class="op">$</span><span class="va">Diff</span> <span class="op">&lt;-</span> <span class="va">df_compare2</span><span class="op">$</span><span class="va">Exclude_Import</span> <span class="op">-</span> <span class="va">df_compare2</span><span class="op">$</span><span class="va">Exclude_R</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">tbl_diff2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">df_compare2</span><span class="op">$</span><span class="va">Diff</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">tbl_diff2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Var1 | Freq|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |:----|----:|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |0    |   47|</span>
<span class="r-in"><span><span class="co"># sort</span></span></span>
<span class="r-in"><span><span class="va">df_compare2</span> <span class="op">&lt;-</span> <span class="va">df_compare2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">Diff</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Number with issues</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">df_compare2</span><span class="op">$</span><span class="va">Diff</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-in"><span><span class="co"># total samples</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df_compare2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 47</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># confusion matrix</span></span></span>
<span class="r-in"><span><span class="va">tbl_results2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">df_tst2</span><span class="op">$</span><span class="va">Exclude</span>, <span class="va">df_tst2</span><span class="op">$</span><span class="va">Exclude_New</span>, useNA <span class="op">=</span> <span class="st">"ifany"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># Show differences</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">tbl_results2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |      | FALSE| TRUE|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |:-----|-----:|----:|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |FALSE |   144|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |TRUE  |     0|    1|</span>
<span class="r-in"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">df_compare2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |SampleID                  | Exclude_Import| Exclude_R| Diff|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |:-------------------------|--------------:|---------:|----:|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |02087REF_Bug_2002-08-22_0 |              0|         0|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |03054CSR_Bug_2003-08-18_0 |              0|         0|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |06012CSR_Bug_2006-09-05_0 |              0|         0|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |06027CSR_Bug_2006-07-17_0 |              0|         0|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |06029CSR_Bug_2006-09-27_0 |              0|         0|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |07036OPR_Bug_2007-09-27_0 |              0|         0|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |08CED2518__2015-08-13_0   |              0|         0|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |08ISS4294__2015-08-26_0   |              1|         1|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |08LAK3627__2015-08-10_0   |              0|         0|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |09JEN1318__2015-08-24_0   |              0|         0|    0|</span>
<span class="r-in"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">df_compare2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |SampleID                         | Exclude_Import| Exclude_R| Diff|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |:--------------------------------|--------------:|---------:|----:|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |WAM06600-011609_Bug_2014-07-07_0 |              0|         0|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |WAM06600-122423__2015-09-17_0    |              0|         0|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |WCFA__2010-08-19_0               |              0|         0|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |lpil66__2010-08-13_0             |              0|         0|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |olneyfh__2013-09-13_0            |              0|         0|    0|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |purdy__2013-09-10_0              |              0|         0|    0|</span>
<span class="r-in"><span><span class="co"># samples with differences</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">samp_diff2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">df_compare2</span><span class="op">[</span><span class="va">df_compare2</span><span class="op">[</span>, <span class="st">"Diff"</span><span class="op">]</span> <span class="op">!=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                                         <span class="st">"SampleID"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] SampleID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;0 rows&gt; (or 0-length row.names)</span>
<span class="r-in"><span><span class="co"># results for only those with differences</span></span></span>
<span class="r-in"><span><span class="va">df_tst_diff2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">df_tst2</span>, <span class="va">SampleID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">samp_diff2</span><span class="op">$</span><span class="va">SampleID</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># add diff field</span></span></span>
<span class="r-in"><span><span class="va">df_tst_diff2</span><span class="op">$</span><span class="va">Exclude_Diff</span> <span class="op">&lt;-</span> <span class="va">df_tst_diff2</span><span class="op">$</span><span class="va">Exclude</span> <span class="op">-</span> <span class="va">df_tst_diff2</span><span class="op">$</span><span class="va">Exclude_New</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Classification Performance Metrics</span></span></span>
<span class="r-in"><span><span class="va">class_TP2</span> <span class="op">&lt;-</span> <span class="va">tbl_results2</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="co"># True Positive</span></span></span>
<span class="r-in"><span><span class="va">class_FN2</span> <span class="op">&lt;-</span> <span class="va">tbl_results2</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="co"># False Negative</span></span></span>
<span class="r-in"><span><span class="va">class_FP2</span> <span class="op">&lt;-</span> <span class="va">tbl_results2</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="co"># False Positive</span></span></span>
<span class="r-in"><span><span class="va">class_TN2</span> <span class="op">&lt;-</span> <span class="va">tbl_results2</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="co"># True Negative</span></span></span>
<span class="r-in"><span><span class="va">class_n2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">tbl_results2</span><span class="op">)</span>  <span class="co"># total</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># sensitivity (recall); TP / (TP+FN); measure model to ID true positives</span></span></span>
<span class="r-in"><span><span class="va">class_sens2</span> <span class="op">&lt;-</span> <span class="va">class_TP2</span> <span class="op">/</span> <span class="op">(</span><span class="va">class_TP2</span> <span class="op">+</span> <span class="va">class_FN2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># precision; TP / (TP+FP); accuracy of model positives</span></span></span>
<span class="r-in"><span><span class="va">class_prec2</span> <span class="op">&lt;-</span> <span class="va">class_TP2</span> <span class="op">/</span> <span class="op">(</span><span class="va">class_TP2</span> <span class="op">+</span> <span class="va">class_FP2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># specifity; TN / (TN + FP); measure model to ID true negatives</span></span></span>
<span class="r-in"><span><span class="va">class_spec2</span> <span class="op">&lt;-</span> <span class="va">class_TN2</span> <span class="op">/</span> <span class="op">(</span><span class="va">class_TN2</span> <span class="op">+</span> <span class="va">class_FP2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># overall accuracy; (TP + TN) / all cases; accuracy of all classifications</span></span></span>
<span class="r-in"><span><span class="va">class_acc2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">class_TP2</span> <span class="op">+</span> <span class="va">class_TN2</span><span class="op">)</span> <span class="op">/</span> <span class="va">class_n2</span></span></span>
<span class="r-in"><span><span class="co"># F1; 2 * (class_prec*class_sens) / (class_prec+class_sens)</span></span></span>
<span class="r-in"><span><span class="co">## balance of precision and recall</span></span></span>
<span class="r-in"><span><span class="va">class_F12</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">class_prec2</span> <span class="op">*</span> <span class="va">class_sens2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">class_prec2</span> <span class="op">+</span> <span class="va">class_sens2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">results_names2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sensitivity (Recall)"</span>,</span></span>
<span class="r-in"><span>                    <span class="st">"Precision"</span>,</span></span>
<span class="r-in"><span>                    <span class="st">"Specificity"</span>,</span></span>
<span class="r-in"><span>                    <span class="st">"Overall Accuracy"</span>,</span></span>
<span class="r-in"><span>                    <span class="st">"F1"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">results_values2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">class_sens2</span>,</span></span>
<span class="r-in"><span>                     <span class="va">class_prec2</span>,</span></span>
<span class="r-in"><span>                     <span class="va">class_spec2</span>,</span></span>
<span class="r-in"><span>                     <span class="va">class_acc2</span>,</span></span>
<span class="r-in"><span>                     <span class="va">class_F12</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">tbl_class2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">results_names2</span>, <span class="va">results_values2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tbl_class2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Performance Metrics"</span>, <span class="st">"Percent"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tbl_class2</span><span class="op">$</span><span class="va">Percent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">tbl_class2</span><span class="op">$</span><span class="va">Percent</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">tbl_class2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Performance Metrics  | Percent|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |:--------------------|-------:|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Sensitivity (Recall) |     100|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Precision            |     100|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Specificity          |     100|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Overall Accuracy     |     100|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |F1                   |     100|</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Erik W. Leppo.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

